import{d as g}from"./chunk-OXZD4PMB.js";import{b as v}from"./chunk-NJNTZ6QT.js";import"./chunk-D22QKJZO.js";var A=/-?([1-9]\d{3,}|0\d{3})-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])T(([01]\d|2[0-3]):[0-5]\d:[0-5]\d(\.\d+)?|(24:00:00(\.0+)?))(Z|(\+|-)((0\d|1[0-3]):[0-5]\d|14:00))?/,i={warnings:[]};function P(a,n=i){return a.behavior&&(a.behavior=t(a.behavior,"behavior",n)),a.width=l(a.width,"width",!1,n),a.height=l(a.height,"height",!1,n),a.duration=l(a.duration,"duration",!0,n),a.format&&typeof a.format!="string"&&(n.warnings.push('"format" should be a single string'),Array.isArray(a.format)&&typeof a.format[0]=="string"?a.format=a.format[0]:a.format=void 0),a}function w(a,n,e=i){return a&&Array.isArray(a)?a.filter(r=>{let s=n(r);return s&&e.warnings.indexOf(s)===-1&&e.warnings.push(s),!s}):a}function t(a,n,e=i){return Array.isArray(a)?a:(e.warnings.push(`"${n}" should be Array of values`),[a])}function h(a,n,e=i){return Array.isArray(a)?(e.warnings.push(`"${n}" should only contain a single value`),a.length===0?void 0:a[0]):a}function l(a,n,e=!1,r=i){if(!(typeof a>"u")){if(typeof a=="string"){let s=e?parseFloat(a):Math.abs(Number(a));if(Number.isNaN(s)||s<=0){r.warnings.push(`"${n}" expected value to be a ${e?"Number":"Integer"}, instead found an invalid value`);return}return r.warnings.push(`"${n}" expected value to be a ${e?"Number":"Integer"}, instead found a string`),s}return!e&&a%1!==0?(r.warnings.push(`"${n}" expected value to be a Integer, instead found a Float`),Math.floor(a)):a}}function d(a,n,e=i){if(Array.isArray(a))return typeof a[0]=="string"?(e.warnings.push(`"${n}" should be a language map instead found a string`),{none:a}):(e.warnings.push(`"${n}" should be a language map instead found an unknown value`),{none:[""]});if(typeof a=="string")return e.warnings.push(`"${n}" should be a language map instead found a string`),{none:[a]};let r=Object.keys(a),s={},u=!1;for(let p of r){let o=a[p],f=[];if(typeof o=="string")u=!0,e.warnings.push(`"${n}" values inside a language map should be an Array of strings, found a string`),f.push(o);else if(Array.isArray(o))for(let y of o)typeof y!="string"?(u=!0,e.warnings.push(`"${n}" values inside a language map should be an Array of strings, found an unknown value`)):f.push(y);else u=!0,e.warnings.push(`"${n}" values inside a language map should be an Array of strings, found an unknown value`);f.length>0&&(s[p]=f)}return u?Object.keys(s).length===0?{none:[""]}:s:a}function c(a,n,e="",r=i){return typeof a=="string"?(r.warnings.push(`"${n}" should be a {label, value} set of Language maps`),{label:{none:[e]},value:{none:[a]}}):((!a.label&&a.value||a.label&&!a.value)&&r.warnings.push(`"${n}" should have both a label and a value`),a.label?a.label=d(a.label,`${n}.label`,r):a.label={none:[e]},a.value?a.value=d(a.value,`${n}.value`,r):a.value={none:[""]},a)}function I(a,n=i){if(a.label&&(a.label=d(a.label,"label",n)),a.summary&&(a.summary=d(a.summary,"summary",n)),a.requiredStatement&&(a.requiredStatement=c(a.requiredStatement,"requiredStatement","Required statement",n)),a.metadata)if(Array.isArray(a.metadata))for(let e=0;e<a.metadata.length;e++)a.metadata[e]=c(a.metadata[e],`metadata.${e}`,"",n);else n.warnings.push('"metadata" should be an array of {label, value} Language maps'),a.metadata=[];if(a.rights&&(Array.isArray(a.rights)&&(n.warnings.push('"rights" should only contain a single string'),a.rights=typeof a.rights[0]=="string"?a.rights[0]:""),typeof a.rights=="string"&&!a.rights.startsWith("http")?n.warnings.push('"rights" should be a valid URI'):typeof a.rights=="string"&&a.rights.startsWith("https")&&(n.warnings.push('"rights" is an informative property and should contain the http variation of the rights statement'),a.rights=`http${a.rights.slice(5)}`)),a.navDate){let e=typeof a.navDate=="string"?a.navDate.trim():void 0;e!==a.navDate&&(n.warnings.push('"navDate" should not contain extra whitespace'),a.navDate=e),(typeof a.navDate!="string"||!a.navDate.match(A))&&(n.warnings.push('"navDate" should be a valid XSD dateTime literal'),a.navDate=void 0)}return a.language&&(a.language=t(a.language,"language",n),a.language=w(a.language,e=>typeof e=="string"?void 0:`'"language" expected array of strings`,n)),a.accompanyingCanvas&&(a.accompanyingCanvas=h(a.accompanyingCanvas,"accompanyingCanvas",n),a.accompanyingCanvas?.type!=="Canvas"&&n.warnings.push('"accompanyingCanvas" should be a Canvas')),a.placeholderCanvas&&(a.placeholderCanvas=h(a.placeholderCanvas,"placeholderCanvas",n),a.placeholderCanvas?.type!=="Canvas"&&n.warnings.push('"placeholderCanvas" should be a Canvas')),a.thumbnail&&(a.thumbnail=t(a.thumbnail,"thumbnail",n)),a}var b={Manifest:"Canvas",Canvas:"AnnotationPage",AnnotationPage:"Annotation"};function $(a,n=i){let e=a.type;switch(e){case"Canvas":case"AnnotationPage":case"Manifest":a&&a.items&&(a.items=w(a.items,r=>r.type===b[e]?void 0:`"${a.type}.items" should contain only type ${b[e]}, found ${r.type}`,n))}return a}function C(a,n=i){return a.logo&&(a.logo=t(a.logo,"logo",n)),a.service&&(a.service=t(a.service,"service",n)),a.seeAlso&&(a.seeAlso=t(a.seeAlso,"seeAlso",n)),a.rendering&&(a.rendering=t(a.rendering,"rendering",n)),a.partOf&&(a.partOf=t(a.partOf,"partOf",n)),a.homepage&&(a.homepage=t(a.homepage,"homepage",n)),a.services&&(a.services=t(a.services,"services",n)),a.supplementary&&(a.supplementary=t(a.supplementary,"supplementary",n)),a.start&&(a.start=h(a.start,"start",n)),a}function L(a){return n=>{if(n)return typeof n=="string"||Array.isArray(n)?n:v({...n,...P(n,a),...I(n,a),...C(n,a),...$(n,a)})}}function k(a,n=i){return g.all(L(n)).traverseManifest(a)}export{k as presentation3StrictUpgrade};
