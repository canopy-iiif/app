import{A as le,B as xe,C as ge,D as ce,E as g,F as u,G as I,H as he,I as c,J as v,K as w,L as F,M as z,a as U,b as N,c as C,d as k,e as Z,f as D,g as G,h as J,i as K,j as V,k as X,l as Y,m as _,n as q,o as ee,p as ie,q as te,r as re,s as oe,t as ae,u as ne,v as fe,w as se,x as me,y as ue,z as pe}from"./chunk-J657UVVW.js";import"./chunk-D22QKJZO.js";function de(i){let e=i.replace(/(https?:\/\/)?(www.)?/i,"");return e.indexOf("/")!==-1?e.split("/")[0]:e}function A(i){try{if(i==="full")return{full:!0};if(i==="square")return{square:!0};let e=i.startsWith("pct:"),o=i.substr(e?4:0).split(",").map(r=>parseFloat(r));return{x:o[0],y:o[1],w:o[2],h:o[3],percent:e}}catch{throw new Error("Expected 'full', 'square' or 'x,y,w,h'. Found "+i)}}function P(i){let e={upscaled:!1,max:!1,confined:!1};if(i[0]==="^"&&(e.upscaled=!0,i=i.slice(1)),i==="max"||i==="full")return e.max=!0,e.serialiseAsFull=i==="full",e;if(i[0]==="!"&&(e.confined=!0,i=i.slice(1)),i[0]==="p")return e.percentScale=parseFloat(i.slice(4)),e;let t=i.split(",").map(o=>o.trim());return t.length&&(t[0]!==""&&(e.width=parseInt(t[0],10)),t[1]!==""&&(e.height=parseInt(t[1],10))),e}function $(i){let e={angle:0};if(i[0]==="!"&&(e.mirror=!0,i=i.substr(1)),e.angle=parseFloat(i)%360,Number.isNaN(e.angle))throw new Error(`Invalid rotation ${i}`);return e}function R(i,e=""){let t=i.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!t)throw new Error(`Invalid or unknown input ${i}`);let o=t[2],r=t[3],a=t[4];if(a[0]==="/"&&(a=a.substring(1)),e.length>0){if(e[0]==="/"&&(e=e.substring(1)),e!==a.substring(0,e.length))throw new Error(`Path does not start with prefix (path: ${a}, prefix: ${e})`);a=a.substring(e.length)}return{scheme:o,server:r,path:a,prefix:e}}function O(i,e=""){let{path:t,scheme:o,server:r,prefix:a}=R(i,e),n=t.split("/").reverse(),[s,f,p,l,...y]=n,x=y.reverse().filter(Boolean).join("/");if(n.length===1||s==="")return{type:"base",scheme:o,server:r,prefix:a,identifier:x};if(s==="info.json"){let[,...E]=n;return{type:"info",scheme:o,server:r,prefix:a,identifier:E.reverse().filter(Boolean).join("/")}}if(typeof o>"u"||typeof r>"u"||typeof t>"u"||typeof l>"u"||typeof p>"u"||typeof f>"u"||typeof s>"u")throw new Error("Invalid image service URL");let[M="",T=""]=s.split(".");return{type:"image",scheme:o,server:r,prefix:a,identifier:x,originalPath:t,region:A(l),size:P(p),rotation:$(f),quality:M,format:T}}function b(i){return g.indexOf(i)!==-1?F:u.indexOf(i)!==-1?w:v}function h(i){let e=i?Array.isArray(i.profile)?i.profile:[i.profile]:[],t={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let o of e)if(typeof o=="string"&&(o=b(o)),!!o){if(o.formats)for(let r of o.formats)t.extraFormats.indexOf(r)===-1&&t.extraFormats.push(r);if(o.qualities)for(let r of o.qualities)t.extraQualities.indexOf(r)===-1&&t.extraQualities.push(r);if(o.supports)for(let r of o.supports)t.extraFeatures.indexOf(r)===-1&&t.extraFeatures.push(r);if(o.maxHeight&&(t.maxHeight=o.maxHeight),o.maxWidth&&(t.maxWidth=o.maxWidth),o.maxArea&&(t.maxArea=o.maxArea),o.extraFormats)for(let r of o.extraFormats)t.extraFormats.indexOf(r)===-1&&t.extraFormats.push(r);if(o.extraQualities)for(let r of o.extraQualities)t.extraQualities.indexOf(r)===-1&&t.extraQualities.push(r);if(o.extraFeatures)for(let r of o.extraFeatures)t.extraFeatures.indexOf(r)===-1&&t.extraFeatures.push(r);o.maxHeight&&(t.maxHeight=o.maxHeight),o.maxWidth&&(t.maxWidth=o.maxWidth),o.maxArea&&(t.maxArea=o.maxArea)}if(i.extraFormats)for(let o of i.extraFormats)t.extraFormats.indexOf(o)===-1&&t.extraFormats.push(o);if(i.extraFeatures)for(let o of i.extraFeatures)t.extraFeatures.indexOf(o)===-1&&t.extraFeatures.push(o);if(i.extraQualities)for(let o of i.extraQualities)t.extraQualities.indexOf(o)===-1&&t.extraQualities.push(o);return t}function Qe(i){let e=Array.isArray(i.profile)?i.profile:[i.profile];for(let t of e)if(typeof t=="string"&&c.indexOf(t)!==-1)return!0;return!1}function W(i){if(i["@id"])return i["@id"];if(i.id)return i.id}function m(i){if(!i||!i.profile||!W(i))return!1;let e=Array.isArray(i.profile)?i.profile:[i.profile];for(let t of e)if(typeof t=="string"&&I.indexOf(t)!==-1)return!0;return!1}function d(i,e){if(!m(i))return[!1,"Not a valid image service"];e.extraFeatures=e.extraFeatures?e.extraFeatures:[];let t=h(i);if(e.exactSize){let o=!1;if(i.sizes)for(let r of i.sizes)r.width&&r.width===e.exactSize.width&&(z.indexOf("sizeByW")!==-1||r.height&&r.height===e.exactSize.height)&&(o=!0),r.height&&r.height===e.exactSize.height&&(z.indexOf("sizeByH")!==-1||r.width&&r.width===e.exactSize.width)&&(o=!0);o||(e.maxWidth=Math.max(e.maxWidth||0,e.exactSize.width||0)||void 0,e.maxHeight=Math.max(e.maxHeight||0,e.exactSize.height||0)||void 0,e.maxArea=Math.max(e.maxArea||0,(e.exactSize.width&&e.exactSize.height?e.exactSize.width*e.exactSize.height:e.maxArea)||0)||void 0,!e.exactSize.height&&e.exactSize.width?e.extraFeatures.indexOf("sizeByW")===-1&&e.extraFeatures.push("sizeByW"):!e.exactSize.width&&e.exactSize.height&&e.extraFeatures.indexOf("sizeByH")===-1&&e.extraFeatures.push("sizeByH"))}if(e.maxArea&&t.maxArea&&e.maxArea>t.maxArea)return[!1,`Max area is ${t.maxArea}`];if(e.maxWidth&&t.maxWidth&&e.maxWidth>t.maxWidth)return[!1,`Max width is ${t.maxWidth}`];if(e.maxHeight&&t.maxHeight&&e.maxHeight>t.maxHeight)return[!1,`Max height is ${t.maxHeight}`];if(e.extraFeatures){let o=[];for(let r of e.extraFeatures)t.extraFeatures.indexOf(r)===-1&&o.push(r);if(o.length)return[!1,`Missing features: ${o.join(", ")}`]}if(e.extraFormats){let o=[];for(let r of e.extraFormats)t.extraFormats.indexOf(r)===-1&&o.push(r);if(o.length)return[!1,`Missing formats: ${o.join(", ")}`]}if(e.extraQualities){let o=[];for(let r of e.extraQualities)t.extraQualities.indexOf(r)===-1&&o.push(r);if(o.length)return[!1,`Missing qualities: ${o.join(", ")}`]}return[!0]}function Ke(i){if(!m(i))return!1;let e=Array.isArray(i.profile)?i.profile:[i.profile];for(let t of e)if(typeof t=="string"){if(u.indexOf(t)!==-1)return!0}else{let o=[...t.supports||[],...t.extraFeatures||[]];if(o.indexOf("regionByPx")!==-1&&(o.indexOf("sizeByW")!==-1||o.indexOf("sizeByWh")!==-1))return!0}return!1}function Ye(i,e){return d(i,{extraFormats:[e]})}function ei(i,e){if(e.type!=="image")return[!0];let t=[];e.rotation.mirror&&t.push("mirroring"),e.region.percent&&t.push("regionByPct"),e.region.square?t.push("regionSquare"):e.region.full||t.push("regionByPx"),e.rotation.angle&&(e.rotation.angle%90?t.push("rotationArbitrary"):t.push("rotationBy90s")),e.size.confined&&t.push("sizeByConfinedWh"),!e.size.width&&e.size.height&&t.push("sizeByH"),e.size.percentScale&&t.push("sizeByPct"),(i.sizes||[]).find(n=>n.width===e.size.width&&!e.size.height||n.height===e.size.height&&!e.size.width||n.height===e.size.height&&n.width===e.size.width)?t.push("sizeByWhListed"):(e.size.width&&!e.size.height&&t.push("sizeByW"),e.size.width&&e.size.height&&t.push("sizeByWh")),e.size.upscaled&&t.push("sizeUpscaling");let[r,a]=d(i,{extraFeatures:t,extraQualities:[e.quality],extraFormats:[e.format],exactSize:e.size});return r?[!0]:[!1,a]}function B({x:i=0,y:e=0,w:t,h:o,full:r,square:a,percent:n}){if(r)return"full";if(a)return"square";if(typeof t>"u"||typeof o>"u")throw new Error("RegionParameter: invalid region");let s=`${i},${e},${t},${o}`;return n?`pct:${s}`:s}function j({max:i,percentScale:e,upscaled:t,confined:o,width:r,height:a,serialiseAsFull:n,version:s}){let f=[];return t&&f.push("^"),i?(f.push(n?"full":"max"),f.join("")):(o&&f.push("!"),e&&f.push(`pct:${e}`),r&&f.push(`${r}`),f.push(","),a&&s===3&&f.push(`${a}`),f.join(""))}function Q(i){return`${i.mirror?"!":""}${(i.angle||0)%360}`}function H(i,e){let t=i.prefix.startsWith("/")?i.prefix.substring(1):i.prefix,o=`${i.scheme}://${i.server}/${t?`${t}/`:""}${i.identifier}`;if(i.type==="base")return o;if(i.type==="info")return`${o}/info.json`;let{size:r}=i,{region:a,rotation:n,format:s,quality:f}=i;if(e){let p=e["@context"]?Array.isArray(e["@context"])?e["@context"]:[e["@context"]]:[],l=p.indexOf("http://iiif.io/api/image/2/context.json")!==-1,y=p.indexOf("http://iiif.io/api/image/3/context.json")!==-1;if((r.width===e.width&&!r.height||r.height===e.height&&!r.width||r.width===e.width&&r.height===e.height)&&(r={...r,max:!0}),l&&(r.max&&!r.serialiseAsFull&&(r={...r,serialiseAsFull:!0}),!r.max&&r.width&&r.height&&(r={...r,height:void 0}),r={...r,version:2}),y){if(r.max&&r.serialiseAsFull&&(r={...r,serialiseAsFull:!1}),r.width&&!r.height&&e.width&&e.height){let x=e.height/e.width;r={...r,height:Math.ceil(r.width*x)}}r={...r,version:3}}}return[o,B(a),j(r),Q(n),`${f}.${s}`].filter(Boolean).join("/")}function ui(i,e){return H({...i,type:"info"},e)}function L(i){return i.endsWith("info.json")?i:i.endsWith("/")?`${i}info.json`:`${i}/info.json`}function hi(i){let e=O(L(i.id));if(e.type!=="info")throw new Error("Invalid service URL");let t=h(i);return{identifier:e.identifier,originalPath:"",server:e.server,prefix:e.prefix,scheme:e.scheme,type:"image",quality:t.extraQualities.indexOf("default")===-1?t.extraQualities[0]:"default",region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:"jpg",rotation:{angle:0}}}function Si(i,e,t){let o=t.length,r=[];for(let a=0;a<o;a++){let n=t[a];if(!n)continue;let s=n.width;r.push(i/s)}return r}function zi(i,e,t){let o=t.length,r=[];for(let a=0;a<o;a++){let n=t[a];n&&r.push({width:Math.floor(i/n),height:Math.floor(e/n)})}return r}function S(i,e){if(e&&e.profile){let t=e.profile;if(t){let o=Array.isArray(t)?t:[t];if(o.includes(`level${i}`)||o.includes(`http://iiif.io/api/image/2/level${i}.json`)||o.includes(`http://iiif.io/api/image/1/level${i}.json`)||o.includes(`http://iiif.io/api/image/1/profiles/level${i}.json`))return!0;if(i===2){for(let r of o)if(g.includes(r))return!0}if(i===1){for(let r of o)if(u.includes(r))return!0}if(i===0){for(let r of o)if(c.includes(r))return!0}}}return!1}function Pi(i){return m(i)?S(0,i)?0:S(1,i)?1:S(2,i)?2:null:null}function Oi(i){let e=i.service?Array.isArray(i.service)?i.service:[i.service]:[],t=e.length,o=[];for(let r=0;r<t;r++)m(e[r])&&o.push(e[r]);return o}function Wi(i){if(i["@type"])return i["@type"];if(i.type)return i.type}function ji(i){let e=i.replace(/(https?:\/\/)?(www.)?/i,"");return e.indexOf("/")!==-1?e.split("/")[0]:e}export{_ as IIIF_1_IMAGE_LEVEL_0,q as IIIF_1_IMAGE_LEVEL_0_PROFILE,ee as IIIF_1_IMAGE_LEVEL_1,ie as IIIF_1_IMAGE_LEVEL_1_PROFILE,te as IIIF_1_IMAGE_LEVEL_2,re as IIIF_1_IMAGE_LEVEL_2_PROFILE,oe as IIIF_2_IMAGE_LEVEL_0,xe as IIIF_2_IMAGE_LEVEL_0_NO_JSON,ae as IIIF_2_IMAGE_LEVEL_0_PROFILE,ne as IIIF_2_IMAGE_LEVEL_1,ge as IIIF_2_IMAGE_LEVEL_1_NO_JSON,fe as IIIF_2_IMAGE_LEVEL_1_PROFILE,se as IIIF_2_IMAGE_LEVEL_2,ce as IIIF_2_IMAGE_LEVEL_2_NO_JSON,me as IIIF_2_IMAGE_LEVEL_2_PROFILE,ue as IIIF_3_IMAGE_LEVEL_0,pe as IIIF_3_IMAGE_LEVEL_1,le as IIIF_3_IMAGE_LEVEL_2,G as STANFORD_IIIF_1_IMAGE_COMPLIANCE_0,J as STANFORD_IIIF_1_IMAGE_COMPLIANCE_1,K as STANFORD_IIIF_1_IMAGE_COMPLIANCE_2,V as STANFORD_IIIF_1_IMAGE_CONFORMANCE_0,X as STANFORD_IIIF_1_IMAGE_CONFORMANCE_1,Y as STANFORD_IIIF_1_IMAGE_CONFORMANCE_2,U as STANFORD_IIIF_IMAGE_COMPLIANCE_0,N as STANFORD_IIIF_IMAGE_COMPLIANCE_1,C as STANFORD_IIIF_IMAGE_COMPLIANCE_2,k as STANFORD_IIIF_IMAGE_CONFORMANCE_0,Z as STANFORD_IIIF_IMAGE_CONFORMANCE_1,D as STANFORD_IIIF_IMAGE_CONFORMANCE_2,L as canonicalServiceUrl,h as combineProfiles,hi as createImageServiceRequest,z as extraFeatures,Si as extractFixedSizeScales,zi as fixedSizesFromScales,W as getId,Pi as getImageServiceLevel,Oi as getImageServices,Wi as getType,ji as identifyImageServer,I as imageServiceProfiles,ui as imageServiceRequestInfo,H as imageServiceRequestToString,Ye as imageServiceSupportsFormat,ei as imageServiceSupportsRequest,m as isImageService,S as isImageServiceLevel,Qe as isLevel0,v as level0,he as level0Support,w as level1,u as level1Support,F as level2,g as level2Support,b as levelToProfile,c as onlyLevel0,de as parseImageServerFromId,O as parseImageServiceRequest,R as parseImageServiceUrl,A as parseRegionParameter,$ as parseRotationParameter,P as parseSizeParameter,B as regionParameterToString,Q as rotationParameterToString,j as sizeParameterToString,d as supports,Ke as supportsCustomSizes};
