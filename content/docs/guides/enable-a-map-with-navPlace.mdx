---
title: Enable the map
description: Surface navPlace points from manifests on a browsable map.
---

# Enable the map with navPlace

Canopy can render a `/map` page that plots every manifest with a `navPlace` entry. Each point becomes
an interactive marker that links to the work page. This guide walks through enabling the feature,
adding tile layers, and wiring the route into your navigation.

> **Note:** The map currently supports `navPlace` features whose geometry type is `Point`.

## 1. Ensure manifests expose navPlace

Update your source manifests so they include the navPlace context and a FeatureCollection with point
geometry.

```json filename="manifest.json" {2,8-21}
{
  "@context": [
    "https://iiif.io/api/extension/navplace/context.json",
    "http://iiif.io/api/presentation/3/context.json"
  ],
  "id": "https://digital.lib.utk.edu/assemble/manifest/wcc/271",
  "type": "Manifest",
  "navPlace": {
    "id": "https://digital.lib.utk.edu/notdereferenceable/featurecollection/1",
    "type": "FeatureCollection",
    "features": [
      {
        "id": "https://digital.lib.utk.edu/notdereferenceable/feature/1",
        "type": "Feature",
        "properties": {
          "label": {"en": ["Summit of Pine Mt. Chilhowee Range"]}
        },
        "geometry": {
          "type": "Point",
          "coordinates": [-83.91907, 35.59647]
        }
      }
    ]
  }
}
```

Restart `npm run dev` (or rerun the build) after updating manifest data so the cache picks up the new
fields.

## 2. Configure the map in `canopy.yml`

Add a `map` block with at least one tile layer and set `enabled: true`.

```yaml filename="canopy.yml" {20-46}
map:
  enabled: true
  defaultBounds:
    - [35.49, -83.92]
    - [35.71, -83.71]
  icon:
    iconUrl: images/marker-icon.png
    iconSize: [24, 36]
    iconAnchor: [12, 36]
  tileLayers:
    - name: OpenTopoMap
      url: https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png
      attribution: >-
        &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>
        contributors
    - name: OpenStreetMap
      url: https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png
      attribution: >-
        &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>
        contributors
```

Options:

- **`defaultBounds`** sets the initial viewport (southwest and northeast coordinates). Leave it out to
  let Leaflet auto-fit based on the plotted points.
- **`tileLayers`** accepts one or more XYZ sources. The first entry becomes the default layer; the map
  UI lets visitors switch between the rest.
- **`icon`** overrides the marker asset and sizing. Host custom icons under `assets/` (e.g.,
  `assets/images/marker.png`) so they are copied into `site/images` at build time.

## 3. Link the route in navigation

Add `/map` to `content/_meta.json` so the global header exposes the page:

```json filename="content/_meta.json" {3-11}
[
  {"path": "/", "text": "Home"},
  {"path": "/works", "text": "Works"},
  {"path": "/map", "text": "Map"},
  {"path": "/docs", "text": "Docs"}
]
```

## 4. Preview the map

1. Run `npm run dev` and visit `/map`.
2. Confirm that each manifest with a `navPlace` entry renders a marker.
3. Toggle tile layers via the control in the top-right corner.
4. Click markers to navigate to the corresponding work page.

If markers do not appear, check the terminal logsâ€”Canopy warns when manifests include unsupported
geometry types or malformed coordinates. Delete `.cache/iiif` and rebuild if you recently added
navPlace data but still see stale results.
