import { Box } from '@canopy-iiif/app/docs-legacy-compat';

# Search and Work Results

Canopy IIIF automatically provides a route to all works in a collection at `/works`. Each Manifest in the IIIF Collection
is represented on this page. This same template is displayed when a user searches for a term in the search bar at the
top of the screen. This page displays labels and thumbnails for all works in the collection and are lazily loaded as
the user scrolls down the page.

## Features

The search and work results page is composed of several features that are available automatically:

- Results List
- Filter

<Box m="9" my="6">
  ![canopy work results](/examples/features-search-1.png)
</Box>

### Results List

The results list is a masonry layout of all works in the collection or the corresponding search results when loaded as
search results or limited via the [Filter](#Filter). Each work is represented by a `figure` element that is made up of a
representative thumbnail and the Manifest label. The figures are hyper linked to the corresponding work page. The list
is lazily loaded as the user scrolls down the page.

### Filter

The Filter element allows a user to limit the results list to a specific set of works. The filter options are determined
by the values of the `metadata` property in the `config/canopy.json` file. From the filter, a user can limit the results
by one value from each metadata field. Once the user clicks _View Results_, the results list will be limited to only
the works that match the selected filter options.

### Customize Result Layouts

Search results rendered via `<SearchResults />` pull their markup from partials in
`content/search`. Two files are evaluated automatically:

- `_result-figure.mdx` — used for IIIF works rendered as figures/cards. The default
  implementation wraps the shared `<Card />` component.
- `_result-article.mdx` — used for textual/annotation hits (pages, docs, etc.) and
  renders an `<ArticleCard />`.

Both files receive `props.record`, `props.query`, and other metadata so they can inject
custom semantics or additional UI. Template authors can import `Card`, `ArticleCard`, or any
other UI components exposed by `@canopy-iiif/app/ui` to tailor the experience without
touching the React runtime. If either partial is removed, Canopy falls back to the
built-in defaults to keep search functional.

#### Configure Layouts and Templates via `canopy.yml`

The builder also reads `search.results` from `canopy.yml` to configure the tab order and the
layout/template for each record type. Keys map to the record `type` emitted in the search
index (e.g., `work`, `page`, or any custom type assigned via frontmatter). The order of the
keys controls the tab order; any types omitted from the map are appended to the end using
the default `list` + `article` fallback.

```yaml copy filename="canopy.yml"
search:
  results:
    work:
      layout: grid   # options: grid | list
      result: figure # options: figure | article
    page:
      layout: list
      result: article
```

This configuration keeps works in the masonry grid with figure-based cards while forcing
pages (or documentation types defined via frontmatter) into a list of text articles. If the
`search.results` map is omitted the legacy behavior remains (works grid first, other types
follow in their default order).
